# Localized SEO Frontend

Next.js App Router frontend for localized recipe pages (`en`, `fr`) with API-driven content and SEO metadata.

## ðŸ“– Full Tutorial & Practical Guide
This repository is the official example project for the detailed guide: 
**[Next.js 15: Localized SEO Practical Guide](https://medium.com/nolooptech/next-js-15-localized-seo-practical-guide-9a4b5b441f65)**.

In this article, we go deep into:
- **Architecting `app/[lang]` routing** for maximum crawlability.
- **Automating Hreflang & Canonical tags** using the Next.js 15 Metadata API.
- **Building Localized Sitemaps** that search engines actually trust.
- **Avoiding the "Client-Side Shift" trap** that kills international rankings.

> **Note:** To see the full implementation, including the localized data layer, check out the [Backend Reference Repository](https://github.com/PasinDeveloper/localized-seo-backend).

## Requirements

- Node.js 18+
- Yarn

## Setup

From the frontend repository root:

```bash
yarn install
```

Configure frontend environment variables (`frontend/.env*`):

```dotenv
NEXT_PUBLIC_API_BASE_URL=http://localhost:3010
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_INTERNAL_API_KEY=your-dev-key
```

`NEXT_PUBLIC_INTERNAL_API_KEY` must match backend `.env` for the in-app seed trigger.

## Run

Run each service from its own repository:

```bash
# in backend repo
yarn start:dev

# in frontend repo
yarn dev
```

Frontend runs at `http://localhost:3000`.

## Data and localization model

- Recipe content is fetched from backend APIs only (`/recipes`, `/recipes/:idOrSlug`).
- Frontend does not consume static recipe JSON snapshots.
- Localized variants share the same recipe index:
  - Example: `en-recipe-001` and `fr-recipe-001`.

## Centralized API hooks

- Use `src/lib/useApiQuery.ts` for all read operations.
- Use `src/lib/useApiMutation.ts` for all write operations.
- `useApiMutation` accepts any custom mutation function.
- `useApiMethodMutation` supports HTTP mutation methods directly:
  - `POST`
  - `PUT`
  - `PATCH`
  - `DELETE`
- Use `runApiMutationRequest` for shared non-hook mutation request helpers.

## SEO behavior

- Route metadata is localized (canonical + `hreflang` alternates).
- `robots.txt` is generated by Next.js route metadata.
- `sitemap.xml` is generated from backend API data and revalidates every 60 seconds.
- Sitemap emits one canonical recipe URL per localized recipe group with alternates to avoid duplicate-looking entries.

## Test: sitemap regeneration after DB changes

### 1) Capture current sitemap

In PowerShell:

```powershell
Invoke-WebRequest http://localhost:3000/sitemap.xml -OutFile .\sitemap-before.xml
```

### 2) Change backend data

Use any one method:

- Add or update a recipe via API/database.
- Or reseed (test-only reset):

```bash
# in backend repo
yarn seed
```

### 3) Wait for revalidation window

Wait at least 60 seconds.

### 4) Fetch sitemap again

```powershell
Invoke-WebRequest http://localhost:3000/sitemap.xml -OutFile .\sitemap-after.xml
```

### 5) Compare

```powershell
Compare-Object (Get-Content .\sitemap-before.xml) (Get-Content .\sitemap-after.xml)
```

Expected:

- Changed recipe URLs and/or `<lastmod>` values appear.
- `hreflang` alternates remain present.
